---
phase: 11
plan: 02
title: "Flow Terms and PERSON Deny List Expansion"
wave: 2
depends_on: ["11-01"]
files_modified:
  - app/config.py
autonomous: true
estimated_tasks: 2
---

# Plan 11-02: Flow Terms and PERSON Deny List Expansion

## Goal

Eliminate LOCATION false positives (33% of total) from flow terminology and PERSON false positives (9%) from clinical descriptors by expanding the respective deny lists.

## Context

From Phase 10 FALSE_POSITIVE_LOG.md:
- **15 LOCATION false positives** from "high" (in "high flow"), "on high", "low" (in "low flow"), "on low"
- **4 PERSON false positives** from "barky", "bedside", "room" (in "room air")

This plan depends on 11-01 completing DENY-03 (LOCATION substring matching behavior) so that multi-word phrases like "high flow" can be effectively filtered.

## must_haves

1. "high flow", "low flow", "on high", "on low" are NOT flagged as LOCATION
2. Standalone "high" and "low" in medical context are NOT flagged as LOCATION
3. "barky", "bedside" are NOT flagged as PERSON
4. "room air" context is preserved (room not flagged as PERSON)
5. Legitimate location PHI (cities, addresses) still detected
6. All existing tests pass (no regressions)

## Tasks

<task id="1">
<title>Add flow terminology to LOCATION deny list</title>
<instructions>
**PREREQUISITE VERIFICATION (BLOCKING)**: Before proceeding, verify that Plan 11-01 Task 2 completed successfully:
```bash
grep -A5 "LOCATION" app/deidentification.py | grep "any(term.lower() in detected_lower"
```
This should show the substring matching code.

**STOP CONDITION: If grep returns no output, HALT EXECUTION and report:**
"Plan 11-01 Task 2 (LOCATION substring matching) must complete first. The deny list additions in this plan depend on substring matching behavior. Do not proceed with flow term additions until 11-01 is verified complete."

**Only proceed with the instructions below if grep confirms the substring matching code exists.**

Edit app/config.py to expand the `deny_list_location` field.

Add these respiratory/oxygen flow terms:

**Flow rates (high/low are commonly flagged):**
- "high flow"
- "low flow"
- "on high"
- "on low"
- "high" (standalone - common in respiratory context)
- "low" (standalone - common in respiratory context)

**Flow-related terms that might get flagged:**
- "flow"
- "nasal high flow"
- "high flow nasal cannula"
- "HFNC" (abbreviation for high flow nasal cannula)

**Room air (already have RA but need variations):**
- "room air" (the phrase, not just RA)

**Unit names that might be detected (ensure they stay protected):**
- "PICU" (already in PERSON list, add to LOCATION too)
- "NICU" (already in PERSON list, add to LOCATION too)
- "ICU"
- "ED" (already present)

**Additional medical terms that could be flagged as location:**
- "bedside" (location context but not PHI)
- "floor" (as in hospital floor - clinical context)

Add with comments explaining the category.

Note: With LOCATION now using substring matching (from 11-01), adding "high" and "low" will filter any LOCATION detection containing those words. This is the desired behavior since legitimate location PHI (city names, addresses) rarely contain these words in isolation.
</instructions>
<verification>
Run: `python test_presidio.py -i`
Test these phrases - should NOT flag "high" or "low" as LOCATION:
- "patient on high flow oxygen"
- "weaning from high to low flow"
- "currently on high, doing well"
- "sats stable on low flow"
- "room air trial in progress"

Verify each returns the input unchanged (no [LOCATION] marker for these terms).
</verification>
</task>

<task id="2">
<title>Add clinical descriptors to PERSON deny list</title>
<instructions>
Edit app/config.py to expand the `deny_list_person` field.

Add these clinical descriptors that get flagged as person names:

**Clinical symptom descriptors:**
- "barky" (croup cough descriptor - sounds like a name to NER)

**Location descriptors in clinical context:**
- "bedside" (as in "at bedside" or "bedside nurse")
- "room" (as in "room air" - the word "room" alone)

**Additional medical terms that sound like names:**
- "stable" (rarely but can be flagged)
- "critical" (rarely but can be flagged)

**Respiratory terms (prevent over-detection):**
- "flow" (prevent "Flow" from being detected as name)

Add with comments explaining why each term is included.
</instructions>
<verification>
Run: `python test_presidio.py -i`
Test these phrases - should NOT flag these terms as PERSON:
- "barky cough consistent with croup"
- "mom at bedside, concerned"
- "patient on room air"
- "bedside nurse updated"

Verify each returns the input unchanged (no [NAME] marker for these clinical terms).
</verification>
</task>

## Verification Criteria

After completing all tasks:

1. **Flow terminology fixed**: "high flow", "low flow", "on high", "on low" not flagged as LOCATION
2. **Clinical descriptors fixed**: "barky", "bedside", "room" not flagged as PERSON
3. **No regressions**: Full test suite passes
4. **Legitimate PHI still detected**: Names like "Sarah Johnson" still detected as PERSON

Run final verification:
```bash
pytest tests/test_deidentification.py -v
python test_presidio.py
```

## Notes

- This plan depends on 11-01's LOCATION matching behavior change
- Adding "high" and "low" to LOCATION deny list is broad but appropriate because:
  - In pediatric handoffs, "high" and "low" overwhelmingly refer to oxygen flow rates
  - Legitimate PHI locations (cities like "High Point" or "Low Moor") are extremely rare in handoffs
  - The risk of over-filtering legitimate locations is much lower than the 15 false positives eliminated
- "room" in PERSON deny list handles "room air" context naturally without complex pattern matching
